---
description: 백엔드(NestJS) 요구지침 및 역할
globs: ["apps/backend/**", "workers/**", "crawler/**"]
alwaysApply: false
---
# 04. 백엔드 요구지침

## 역할
- API 게이트웨이 (유저 요청 → 데이터 수집/가공/리포트)
- 네이버 API 호출 관리 (검색광고, 데이터랩)
- 크롤러(Playwright) 관리 (자동완성/연관검색어, 블로그 태그)
- 캐시/DB/큐 연동
- 레이트리미터/서킷브레이커/폴백 적용

## 기술
- NestJS + TypeORM(MySQL)
- Redis (캐시, 레이트리밋, 디듀프, 서킷 상태)
- BullMQ (비동기 잡, 재시도/백오프, 야간 배치)
- Playwright (저빈도·저동시성 크롤링)

## 지침
- 외부 API 호출 시 반드시 **큐를 통해 조율**
- DB에는 보존 가치 있는 데이터만 저장 (검색량/트렌드/로그/스냅샷)
- 캐시는 TTL 기반(검색량 7~30d, 트렌드 6~24h, 연관어 24~72h)
- 장애 시 **캐시/DB 스냅샷 폴백 → 백그라운드 갱신 예약**
