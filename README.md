# 키워드 셀렉터 (Keyword Selector)

네이버 블로그 키워드 리서치 서비스 - MVP v0.2.0

## 📋 프로젝트 개요
D.I.A 관점의 검색 의도 충족 글쓰기를 위한 키워드 리서치 도구입니다.

### 🎯 주요 기능

#### 🔄 **무한반복 키워드 조회** (NEW!)
- **자동 연관 키워드 탐색**: 초기 키워드로부터 연관 키워드를 자동으로 찾아 반복 조회
- **중복 키워드 자동 건너뛰기**: 이미 조회한 키워드는 자동으로 제외
- **실시간 진행률 표시**: 조회 진행 상황과 현재 처리 중인 키워드 실시간 표시
- **상세 키워드 분석**: PC/모바일 월간검색수, 총 검색수, 문서수, 경쟁률 제공
- **CSV 다운로드**: 조회 결과를 엑셀에서 활용 가능한 CSV 형태로 다운로드

#### 📋 **조회 기록 관리** (NEW!)
- **로컬스토리지 기반**: 브라우저에 검색 기록 자동 저장 (최대 50개)
- **전체 키워드 목록**: 저장된 모든 키워드 데이터 확장/접기 기능
- **키워드 복사 기능**: 개별 키워드 복사 및 전체 키워드 일괄 복사
- **검색 기록 관리**: 개별 삭제, 전체 삭제 기능
- **통계 정보 표시**: 조회된 키워드 수, 중복 건너뛰기, 총 검색량 등

#### 🔍 **기존 키워드 분석 기능**
- **검색량/경쟁도 분석**: 다중 소스 API 활용 (블로그, 뉴스, 카페, 쇼핑)
  - 종합 경쟁도 지수 계산 (0.0~1.0)
  - 상업적 경쟁 최소화로 SEO 최적화
  - HIGH/MEDIUM/LOW 등급 자동 분류
- **검색 트렌드**: 네이버 데이터랩 API 기반 실시간 트렌드
  - 최근 30일 일별 데이터
  - 시각화 가능한 JSON 형태 제공
- **연관 검색어**: 네이버 자동완성 API 실시간 연동
  - 실제 사용자 검색 패턴 반영
  - 관련도 점수 포함
  - 가짜 데이터 완전 배제
- **태그 후보**: 다중 소스 크롤링 기반 태그 추천
  - 블로그/뉴스/카페 통합 분석
  - 빈도 기반 우선순위 정렬
  - 카테고리별 분류 (주요/일반/기타)

### 🛠 기술 스택

- **모노레포**: Turbo + Workspaces
- **프론트엔드**: Next.js 14 + TypeScript + Emotion + React Query
- **백엔드**: NestJS + 메모리 기반 저장소 + Bull Queue
- **캐시/큐**: Redis + BullMQ (키워드 분석 작업 큐)
- **외부 API**: 네이버 검색 API, 데이터랩 API, 자동완성 API
- **크롤링**: Cheerio 기반 웹 스크래핑
- **컨테이너**: Docker + Docker Compose
- **스타일링**: Emotion CSS-in-JS + 글로벌 CSS 리셋

## 🚀 시작하기

### 1. 저장소 클론

\`\`\`bash
git clone https://github.com/your-username/keyword-selector.git
cd keyword-selector
\`\`\`

### 2. 환경 변수 설정

\`\`\`bash
cp env.example .env.local
# .env.local 파일을 편집하여 실제 값으로 설정
\`\`\`

### 3. 의존성 설치

\`\`\`bash
npm install
\`\`\`

### 4. 개발 환경 실행

#### Docker Compose 사용 (권장)

\`\`\`bash
# 전체 서비스 실행
docker-compose up -d

# 로그 확인
docker-compose logs -f
\`\`\`

#### 로컬 개발

\`\`\`bash
# Redis 먼저 실행 (캐시/큐 용도)
docker-compose up -d redis

# 개발 서버 실행
npm run dev
\`\`\`

### 5. 접속

- **프론트엔드**: http://localhost:3000
- **백엔드 API**: http://localhost:3001/api/v1
- **API 문서**: http://localhost:3001/api/docs

## 📁 프로젝트 구조

\`\`\`
keyword-selector/
├── apps/
│   ├── backend/          # NestJS 백엔드
│   │   ├── src/
│   │   │   ├── modules/
│   │   │   │   ├── keyword/     # 키워드 분석 모듈
│   │   │   │   ├── settings/    # 설정 관리 모듈
│   │   │   │   ├── crawler/     # 크롤링 모듈
│   │   │   │   └── report/      # 리포트 모듈
│   │   │   ├── queue/           # BullMQ 작업 큐
│   │   │   ├── common/          # 공통 유틸리티
│   │   │   └── config/          # 설정 파일
│   │   └── BULK_KEYWORD_API.md  # 무한반복 조회 API 문서
│   └── frontend/         # Next.js 프론트엔드
│       ├── src/
│       │   ├── components/      # React 컴포넌트
│       │   │   ├── SearchHistory.tsx      # 조회 기록 컴포넌트
│       │   │   ├── BulkKeywordResearch.tsx # 무한반복 조회 컴포넌트
│       │   │   ├── BulkKeywordForm.tsx     # 조회 폼 컴포넌트
│       │   │   ├── BulkKeywordResults.tsx  # 결과 테이블 컴포넌트
│       │   │   ├── Toast.tsx              # 토스트 알림 컴포넌트
│       │   │   └── ...
│       │   ├── utils/           # 유틸리티 함수
│       │   │   └── localStorage.ts        # 로컬스토리지 관리
│       │   ├── hooks/           # 커스텀 훅
│       │   │   └── useApiKeyStatus.ts     # API 키 상태 훅
│       │   ├── types/           # TypeScript 타입 정의
│       │   ├── lib/             # API 클라이언트
│       │   ├── styles/          # 글로벌 스타일
│       │   │   └── globals.css  # CSS 리셋 및 기본 스타일
│       │   └── app/             # Next.js App Router
├── packages/
│   └── shared/           # 공통 타입 및 유틸리티
├── docker/               # Docker 설정
├── .cursor/rules/        # 프로젝트 규칙
└── docs/                 # 문서
\`\`\`

## 🔧 개발 명령어

\`\`\`bash
# 전체 개발 서버 실행
npm run dev

# 전체 빌드
npm run build

# 전체 테스트
npm run test

# 린트 검사
npm run lint

# 코드 포맷팅
npm run format

# 타입 체크
npm run type-check

# 캐시 정리
npm run clean
\`\`\`

## 📊 아키텍처

### 데이터 플로우

#### 기본 키워드 분석
1. **사용자 요청** → 프론트엔드 (키워드 입력)
2. **API 호출** → 백엔드 `/api/keyword/research`
3. **캐시 확인** → Redis (키워드별 1시간 캐시)
4. **실시간 데이터 수집** → 병렬 API 호출
   - 네이버 블로그/뉴스/카페/쇼핑 검색 API
   - 네이버 데이터랩 트렌드 API
   - 네이버 자동완성 API
   - 웹 크롤링 (태그 추출)
5. **데이터 분석** → 종합 경쟁도 지수 계산
6. **결과 저장** → 메모리 저장소 + Redis 캐시
7. **응답 반환** → 구조화된 JSON 데이터

#### 무한반복 키워드 조회 (NEW!)
1. **사용자 입력** → 초기 키워드 + 조회 개수 설정
2. **API 호출** → 백엔드 `/api/keywords/bulk-research`
3. **큐 기반 처리** → BFS 알고리즘으로 키워드 탐색
4. **중복 검사** → Set 기반 중복 키워드 자동 제외
5. **연관 키워드 수집** → 네이버 자동완성 API 활용
6. **메트릭 수집** → 각 키워드별 상세 분석 데이터
7. **진행률 업데이트** → 실시간 진행 상황 전송
8. **로컬스토리지 저장** → 조회 완료 시 브라우저에 자동 저장

### 캐시 전략

- **전체 리포트**: 1시간 TTL (실시간 데이터 있는 경우)
- **처리중 상태**: 10분 TTL (데이터 수집 중)
- **데이터 신선도**: fresh(6시간 이내) / stale(24시간 이내) / processing(24시간 초과)
- **키워드별 개별 캐시**: 24시간 데이터 갱신 주기
- **로컬스토리지**: 최대 50개 검색 기록 보관 (FIFO 방식)

## 🔒 보안 및 준법

- 네이버 API 약관 준수
- robots.txt 준수
- User-Agent 명시
- 랜덤 지연 및 동시성 제한 (0.5초 간격)
- 비밀키 안전 저장 (메모리 기반)
- PII 데이터 보호
- API 키 마스킹 처리

## 📈 구현 완료 기능

### ✅ 백엔드 API (v0.2.0)

#### 무한반복 키워드 조회 API
- **엔드포인트**: `POST /api/v1/keywords/bulk-research`
- **BFS 알고리즘**: 큐 기반 키워드 탐색으로 연관 키워드 자동 발견
- **중복 방지**: Set 기반 중복 키워드 자동 건너뛰기
- **실시간 메트릭**: PC/모바일 월간검색수, 문서수, 경쟁률 상세 분석
- **API 호출 제한**: 0.5초 간격으로 안전한 API 호출
- **Fallback 시스템**: API 키 미설정 시 랜덤 데이터 생성
- **로깅 시스템**: 상세한 디버그 로그 및 진행 상황 추적

#### 기존 키워드 분석 API
- **키워드 리서치 엔드포인트**: `/api/v1/keywords/research`
- **다중 소스 데이터 수집**: 병렬 API 호출로 성능 최적화
- **종합 경쟁도 분석**: 4개 소스 가중치 기반 계산
- **실시간 데이터 우선**: 가짜 데이터 완전 배제
- **캐싱 시스템**: Redis 기반 효율적 데이터 관리
- **에러 핸들링**: API 실패 시 안정적 처리
- **설정 관리 API**: `/api/v1/settings/api-keys` - 네이버 API 키 동적 관리

### ✅ 프론트엔드 UI/UX (v0.2.0)

#### 조회 기록 관리 시스템 (NEW!)
- **SearchHistory 컴포넌트**: 메인 페이지를 조회 기록으로 변경
- **로컬스토리지 연동**: 검색 기록 자동 저장 및 관리 (최대 50개)
- **카드형 UI**: 깔끔한 카드 레이아웃으로 기록 표시
- **통계 정보**: 조회된 키워드 수, 중복 건너뛰기, 총 검색량 표시
- **시간 표시**: 상대적 시간 표시 ("방금 전", "2시간 전" 등)
- **키워드 미리보기**: 상위 5개 키워드 태그 형태로 표시
- **전체 키워드 목록**: 확장/접기 기능으로 모든 키워드 표시
- **키워드 복사 기능**: 개별 복사 및 전체 일괄 복사
- **삭제 기능**: 개별 기록 삭제 및 전체 삭제
- **빈 상태 처리**: 기록이 없을 때 안내 메시지

#### 무한반복 키워드 조회 UI (NEW!)
- **BulkKeywordResearch 컴포넌트**: 전체 무한반복 조회 페이지
- **BulkKeywordForm**: 초기 키워드 입력 및 조회 개수 설정 폼
- **API 키 연결 상태 확인**: 실시간 API 키 상태 체크 및 폼 비활성화
- **실시간 진행률**: 프로그레스 바와 현재 처리 키워드 표시
- **BulkKeywordResults**: 정렬 가능한 결과 테이블
- **CSV 다운로드**: 조회 결과를 엑셀에서 활용 가능한 형태로 다운로드
- **검색 및 필터링**: 키워드 검색 및 다양한 정렬 옵션
- **사용 팁**: 효과적인 키워드 조회를 위한 가이드 제공

#### 기존 UI 컴포넌트
- **환경설정 컴포넌트**: 네이버 API 키 설정 및 관리
- **실시간 API 키 상태 표시**: 마스킹된 키 정보 및 연결 상태
- **API 연결 테스트**: 실시간 유효성 검증 기능
- **동적 버튼 상태**: 연결 상태에 따른 "연결 끊기" / "입력 초기화" 전환
- **필수 필드 검증**: 모든 API 키 필드 필수 입력 및 개별 유효성 검사
- **토스트 알림 시스템**: 성공/실패/경고 상황별 명확한 피드백

#### 글로벌 스타일링 (NEW!)
- **CSS 리셋**: box-sizing: border-box, margin: 0, padding: 0 전역 적용
- **일관된 박스 모델**: 모든 요소에서 동일한 크기 계산 방식
- **폰트 스무딩**: 크로스 브라우저 텍스트 렌더링 최적화
- **커스텀 스크롤바**: 웹킷 브라우저용 스크롤바 스타일링
- **반응형 기본 설정**: 이미지 및 요소 반응형 처리

### ✅ 데이터 분석 알고리즘
- **검색량 계산**: `블로그×1.8 + 뉴스×2.2 + 카페×1.5 + 쇼핑×0.5`
- **경쟁도 지수**: `(블로그×35% + 뉴스×30% + 카페×25% + 쇼핑×10%) ÷ 50,000`
- **SEO 최적화**: 상업적 경쟁 최소화 (쇼핑 가중치 10%)
- **등급 분류**: HIGH(0.7+) / MEDIUM(0.3-0.7) / LOW(0.3-)

### ✅ 설정 관리 시스템
- **런타임 API 키 관리**: 서버 재시작 없이 API 키 변경 가능
- **메모리 기반 저장**: 빠른 접근과 보안성 확보
- **API 키 마스킹**: 민감 정보 보호 (예: `abcd****efgh`)
- **연결 상태 실시간 추적**: 설정/미설정 상태 즉시 반영
- **유효성 테스트**: 네이버 API 실제 호출을 통한 키 검증

### ✅ 데이터베이스 제거 및 최적화 (v0.1.1)
- **메모리 기반 저장소**: TypeORM 및 MySQL 의존성 완전 제거
- **성능 향상**: 데이터베이스 I/O 제거로 응답 속도 개선
- **단순화된 아키텍처**: 복잡한 ORM 설정 제거로 코드 단순화
- **타입 안전성**: TypeScript 기반 메모리 저장소 구현
- **CRUD 기능 완전 대체**: 생성, 조회, 업데이트, 삭제 기능 유지
- **컬렉션 기반 관리**: 키워드, 메트릭, 트렌드, 연관어, 태그 데이터 분리 저장
- **자동 ID 생성**: 순차적 ID 자동 할당 및 타임스탬프 관리

## 🔄 최신 업데이트 (v0.2.0)

### 🆕 새로운 기능
1. **무한반복 키워드 조회**: BFS 알고리즘 기반 자동 키워드 탐색
2. **조회 기록 관리**: 로컬스토리지 기반 검색 기록 저장 및 관리
3. **키워드 복사 기능**: 개별/일괄 키워드 복사 및 클립보드 연동
4. **글로벌 CSS 리셋**: 일관된 브라우저 렌더링을 위한 기본 스타일 적용
5. **실시간 진행률**: 키워드 조회 진행 상황 실시간 표시
6. **CSV 다운로드**: 조회 결과를 엑셀에서 활용 가능한 형태로 제공

### 🎨 UI/UX 개선
- **메인 페이지 변경**: 키워드셀렉터 → 조회 기록으로 변경
- **카드형 레이아웃**: 검색 기록을 카드 형태로 깔끔하게 표시
- **반응형 그리드**: 키워드 목록을 반응형 그리드로 표시
- **토스트 알림**: 복사 완료/실패 등 사용자 피드백 강화
- **테이블 정렬**: 헤더와 데이터 셀 가운데 정렬 통일

### 🔧 기술적 개선
- **타입 안전성**: TypeScript 인터페이스로 데이터 타입 보장
- **에러 처리**: 클립보드 API fallback 및 안전한 에러 처리
- **성능 최적화**: useCallback, useMemo 활용한 렌더링 최적화
- **메모리 관리**: 로컬스토리지 최대 50개 제한으로 메모리 효율성 확보

## ⚠️ 주요 변경사항 (v0.2.0)
- **메인 페이지**: 키워드셀렉터에서 조회 기록으로 변경
- **데이터 저장**: 무한반복 조회 결과가 로컬스토리지에 자동 저장
- **브라우저 의존성**: 로컬스토리지 기능은 브라우저 환경에서만 동작
- **데이터 영속성**: 브라우저 데이터 삭제 시 조회 기록도 함께 삭제됨

## 🤝 기여하기

1. Fork the Project
2. Create your Feature Branch (\`git checkout -b feature/AmazingFeature\`)
3. Commit your Changes (\`git commit -m 'Add some AmazingFeature'\`)
4. Push to the Branch (\`git push origin feature/AmazingFeature\`)
5. Open a Pull Request

## 📝 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다. 자세한 내용은 \`LICENSE\` 파일을 참조하세요.

## 👨‍💻 개발자

**김동언** - 초기 작업 및 유지보수

---

**MVP v0.2.0** - 2025년 무한반복 키워드 조회 및 조회 기록 관리 시스템 추가